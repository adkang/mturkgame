<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>
	<head>
		<script src="text/javascript"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
		<script src="mturk.js"></script>
    		<script>
			var shipx = 0
			var board =
  				[[0,0,0,1,0,0],
   				[0,0,0,0,1,1],
   				[0,0,0,0,0,0],
   				[0,0,0,0,0,0],
   				[1,1,1,0,0,0],
   				[0,0,0,0,0,0],
   				[0,0,0,0,0,0]];
			var reward = 0

			$(document).ready(function() {
 			 var gameboard = $("<div id='gameboard'></div>");
			 $(document.body).append(gameboard);
				
			for (i = 0; i < board.length; i++) {
				for (j = 0; j < board[0].length; j++) {
					var gridcell = $("<div class='gridcell'></div>");
					var gridcellid = 'gridcell_' + i + '_' + j;
					$(gridcell).attr("id", gridcellid);
			 		$(gameboard).append(gridcell);
				}
			}
			 var ship = $("div class='ship'></div>");
				
			  $(document).keydown(function(e) {
 			   if(e.keyCode==37 && shipx > 0) {
 			     // left arrow clicked
			      shipx -= 1;
 			   } else if(e.keyCode == 39 && shipx < board.length - 1) {
 			     // right arrow clicked
			      shipx += 1;
			    }
				  
			    $(".ship").css("left", shipx + "px");
			  });
				
			  setInterval(function() {
			    var milliseconds = new Date().getTime();
			    var offset = Math.floor((milliseconds / 1000.0) % board.length)
			    for (i = 0; i < board.length - 1; i++) {
			    	for (j = 0; j < board[0].length; j++) {
					var off = i - offset
					if (off < 0) { off = off + board.length }
					if (gameboard[off][j] == 1) {
						$('#'+gridcellid).css("background-color", "blue")
						if (j == shipx) { endGame(milliseconds) }
					}
					else { $('#'+gridcellid).css("background-color", "gray") }
					$(gridcell).attr("id", gridcellid)
			 		$(gameboard).append(gridcell);
					}
			    }
			  }, 500);
				
			function endGame(milliseconds) {
				reward = reward + (Math.floor(milliseconds / 1000.0) * 0.001)
			}
			})
			</script>
			<style>
				
			#gameboard {
			  background-color: gray;
			  width: 300px;
			  height: 300px;
			  position: relative;
			}
			.ship {
			  color: red;
			  width: 50px;
			  height: 50px;
			  position: absolute;
			  left: 0px;
			  top: 0px;
			}
			.gridcell {
			  width: 50px;
			  height: 50px;
			  position: absolute;
			  left: 0px;
			  top: 0px;
			}
			</style>
  	</head>
  <body>
	<form is="mturk_form">
		  
	<input type="hidden" name="bonus">
	  </form>
  </body>
</html>
